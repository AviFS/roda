<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Roda::RodaPlugins::NotAllowed::RequestMethods</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Roda::RodaPlugins::NotAllowed::RequestMethods
</h1>
<ol class='paths'>
<li>
<a href="../../../../files/lib/roda/plugins/not_allowed_rb.html">lib/roda/plugins/not_allowed.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'></div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-is">is</a></li>
<li><a href="#method-i-root">root</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='methods'>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-is'>
<a name='method-i-is'></a>
<div class='synopsis'>
<span class='name'>is</span><span class='arguments'>(*args)</span>

</div>
<div class='description'>

<p>Keep track of verb calls inside the block.  If there are any verb calls inside the block, but the block returned, assume that the verb calls inside the block did not match, and since there was already a successful terminal match, the request method must not be allowed, so return a 405 response in that case.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-is-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-is-source'>    <span class="ruby-comment"># File lib/roda/plugins/not_allowed.rb</span>
<span class="line-num"> 84</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">is</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
<span class="line-num"> 85</span>   <span class="ruby-keyword">super</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) <span class="ruby-keyword">do</span>
<span class="line-num"> 86</span>     <span class="ruby-keyword">begin</span>
<span class="line-num"> 87</span>       <span class="ruby-identifier">is_verbs</span> = <span class="ruby-ivar">@_is_verbs</span> = []
<span class="line-num"> 88</span> 
<span class="line-num"> 89</span>       <span class="ruby-identifier">ret</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num"> 90</span>         <span class="ruby-keyword">yield</span>
<span class="line-num"> 91</span>       <span class="ruby-keyword">else</span>
<span class="line-num"> 92</span>         <span class="ruby-keyword">yield</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">captures</span>)
<span class="line-num"> 93</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 94</span> 
<span class="line-num"> 95</span>       <span class="ruby-keyword">unless</span> <span class="ruby-identifier">is_verbs</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num"> 96</span>         <span class="ruby-identifier">method_not_allowed</span>(<span class="ruby-identifier">is_verbs</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;, &#39;</span>))
<span class="line-num"> 97</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 98</span> 
<span class="line-num"> 99</span>       <span class="ruby-identifier">ret</span>
<span class="line-num">100</span>     <span class="ruby-keyword">ensure</span>
<span class="line-num">101</span>       <span class="ruby-ivar">@_is_verbs</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">102</span>     <span class="ruby-keyword">end</span>
<span class="line-num">103</span>   <span class="ruby-keyword">end</span>
<span class="line-num">104</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-root'>
<a name='method-i-root'></a>
<div class='synopsis'>
<span class='name'>root</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Treat <code>r.root</code> similar to <code>r.get &#39;&#39;</code>, using a 405 response for non-GET requests.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-root-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-root-source'>    <span class="ruby-comment"># File lib/roda/plugins/not_allowed.rb</span>
<span class="line-num">108</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">root</span>
<span class="line-num">109</span>   <span class="ruby-keyword">super</span>
<span class="line-num">110</span>   <span class="ruby-keyword">if</span> <span class="ruby-ivar">@remaining_path</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;/&quot;</span>  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">is_get?</span>
<span class="line-num">111</span>     <span class="ruby-identifier">always</span>{<span class="ruby-identifier">method_not_allowed</span>(<span class="ruby-string">&quot;GET&quot;</span>)}
<span class="line-num">112</span>   <span class="ruby-keyword">end</span>
<span class="line-num">113</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
