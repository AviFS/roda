<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Roda::RodaPlugins::PathRewriter</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Roda::RodaPlugins::PathRewriter
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/roda/plugins/path_rewriter_rb.html">lib/roda/plugins/path_rewriter.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>The path_rewriter plugin allows you to rewrite the remaining path or the path info for requests.  This is useful if you want to transparently treat some paths the same as other paths.</p>

<p>By default, <code>rewrite_path</code> will rewrite just the remaining path.  So only routing in the current <a href="../../Roda.html"><code>Roda</code></a> app will be affected.  This is useful if you have other code in your app that uses PATH_INFO and needs to see the original PATH_INFO (for example, when using relative links).</p>

<pre class="ruby"><span class="ruby-identifier">rewrite_path</span> <span class="ruby-string">&#39;/a&#39;</span>, <span class="ruby-string">&#39;/b&#39;</span>
<span class="ruby-comment"># PATH_INFO &#39;/a&#39; =&gt; remaining_path &#39;/b&#39;</span>
<span class="ruby-comment"># PATH_INFO &#39;/a/c&#39; =&gt; remaining_path &#39;/b/c&#39;</span>
</pre>

<p>In some cases, you may want to override PATH_INFO for the rewritten paths, such as when you are passing the request to another Rack app. For those cases, you can use the <code>path_info: true</code> option to <code>rewrite_path</code>.</p>

<pre class="ruby"><span class="ruby-identifier">rewrite_path</span> <span class="ruby-string">&#39;/a&#39;</span>, <span class="ruby-string">&#39;/b&#39;</span>, <span class="ruby-value">path_info:</span> <span class="ruby-keyword">true</span>
<span class="ruby-comment"># PATH_INFO &#39;/a&#39; =&gt; PATH_INFO &#39;/b&#39;</span>
<span class="ruby-comment"># PATH_INFO &#39;/a/c&#39; =&gt; PATH_INFO &#39;/b/c&#39;</span>
</pre>

<p>If you pass a string to <code>rewrite_path</code>, it will rewrite all paths starting with that string.  You can provide a regexp if you want more complete control, such as only matching exact paths.</p>

<pre class="ruby"><span class="ruby-identifier">rewrite_path</span> <span class="ruby-regexp">/\A\/a\z/</span>, <span class="ruby-string">&#39;/b&#39;</span>
<span class="ruby-comment"># PATH_INFO &#39;/a&#39; =&gt; remaining_path &#39;/b&#39;</span>
<span class="ruby-comment"># PATH_INFO &#39;/a/c&#39; =&gt; remaining_path &#39;/a/c&#39;, no change</span>
</pre>

<p>Patterns can be rewritten dynamically by providing a block accepting a MatchData object and evaluating to the replacement.</p>

<pre class="ruby"><span class="ruby-identifier">rewrite_path</span>(<span class="ruby-regexp">/\A\/a\/(\w+)/</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;/a/#{match[1].capitalize}&quot;</span>}
<span class="ruby-comment"># PATH_INFO &#39;/a/moo&#39; =&gt; remaining_path &#39;/a/Moo&#39;</span>
<span class="ruby-identifier">rewrite_path</span>(<span class="ruby-regexp">/\A\/a\/(\w+)/</span>, <span class="ruby-value">path_info:</span> <span class="ruby-keyword">true</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;/a/#{match[1].capitalize}&quot;</span>}
<span class="ruby-comment"># PATH_INFO &#39;/a/moo&#39; =&gt; PATH_INFO &#39;/a/Moo&#39;</span>
</pre>

<p>All path rewrites are applied in order, so if a path is rewritten by one rewrite, it can be rewritten again by a later rewrite.  Note that PATH_INFO rewrites are processed before remaining_path rewrites.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-configure">configure</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='class-list'>
<h2>Classes and Modules</h2>
<ol>
<li><a href="PathRewriter/ClassMethods.html">Roda::RodaPlugins::PathRewriter::ClassMethods</a></li>
<li><a href="PathRewriter/RequestMethods.html">Roda::RodaPlugins::PathRewriter::RequestMethods</a></li>
</ol>
</div>
<div id='section'>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-configure'>
<a name='method-c-configure'></a>
<div class='synopsis'>
<span class='name'>configure</span><span class='arguments'>(app)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-configure-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-configure-source'>   <span class="ruby-comment"># File lib/roda/plugins/path_rewriter.rb</span>
<span class="line-num">48</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">configure</span>(<span class="ruby-identifier">app</span>)
<span class="line-num">49</span>   <span class="ruby-identifier">app</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-keyword">do</span>
<span class="line-num">50</span>     <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:remaining_path_rewrites</span>] <span class="ruby-operator">||=</span> []
<span class="line-num">51</span>     <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:path_info_rewrites</span>] <span class="ruby-operator">||=</span> []
<span class="line-num">52</span>   <span class="ruby-keyword">end</span>
<span class="line-num">53</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
