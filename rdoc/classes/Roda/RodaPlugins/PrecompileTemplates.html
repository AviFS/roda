<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Roda::RodaPlugins::PrecompileTemplates</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Roda::RodaPlugins::PrecompileTemplates
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/roda/plugins/precompile_templates_rb.html">lib/roda/plugins/precompile_templates.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>The precompile_templates plugin adds support for precompiling template code. This can result in a large memory savings for applications that have large templates or a large number of small templates if the application uses a forking webserver.  By default, template compilation is lazy, so all the child processes in a forking webserver will have their own copy of the compiled template.  By using the precompile_templates plugin, you can precompile the templates in the parent process before forking, and then all of the child processes can use the same precompiled templates, which saves memory.</p>

<p>Another advantage of the precompile_templates plugin is that after template precompilation, access to the template file in the file system is no longer needed, so this can be used with security features that do not allow access to the template files at runtime.</p>

<p>After loading the plugin, you should call precompile_views with an array of views to compile, using the same argument you are passing to view or render:</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:precompile_templates</span>
<span class="ruby-identifier">precompile_views</span> <span class="ruby-node">%w&#39;view1 view2&#39;</span>
</pre>

<p>If the view requires local variables, you should call precompile_views with a second argument for the local variables:</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:precompile_templates</span>
<span class="ruby-identifier">precompile_views</span> <span class="ruby-value">:view3</span>, [<span class="ruby-value">:local_var1</span>, <span class="ruby-value">:local_var2</span>]
</pre>

<p>After all templates are precompiled, you can optionally use freeze_template_caches!, which will freeze the template caches so that any template compilation at runtime will result in an error.  This also speeds up template cache access, since the template caches no longer need a mutex.</p>

<pre class="ruby"><span class="ruby-identifier">freeze_template_caches!</span>
</pre>

<p>Note that you should use Tilt 2.0.1+ if you are using this plugin, so that locals are handled in the same order.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-load_dependencies">load_dependencies</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='class-list'>
<h2>Classes and Modules</h2>
<ol>
<li><a href="PrecompileTemplates/ClassMethods.html">Roda::RodaPlugins::PrecompileTemplates::ClassMethods</a></li>
</ol>
</div>
<div id='section'>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-load_dependencies'>
<a name='method-c-load_dependencies'></a>
<div class='synopsis'>
<span class='name'>load_dependencies</span><span class='arguments'>(app, opts=OPTS)</span>

</div>
<div class='description'>

<p>Load the render plugin as precompile_templates depends on it.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-load_dependencies-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-load_dependencies-source'>   <span class="ruby-comment"># File lib/roda/plugins/precompile_templates.rb</span>
<span class="line-num">45</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">load_dependencies</span>(<span class="ruby-identifier">app</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">46</span>   <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:render</span>
<span class="line-num">47</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
