<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Roda::RodaPlugins::Base::RequestMethods</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>module</span>
          Roda::RodaPlugins::Base::RequestMethods
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../../files/lib/roda_rb.html">lib/roda.rb</a>
          </li>
        </ol>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>Instance methods for <a href="../../RodaRequest.html">RodaRequest</a>,
            mostly related to handling routing for the request.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-new">new</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-block_result">block_result</a></li>
              <li><a target="docwin" href="#attribute-i-captures">captures</a></li>
              <li><a target="docwin" href="#method-i-get">get</a></li>
              <li><a target="docwin" href="#method-i-halt">halt</a></li>
              <li><a target="docwin" href="#method-i-inspect">inspect</a></li>
              <li><a target="docwin" href="#method-i-is">is</a></li>
              <li><a target="docwin" href="#method-i-is_get-3F">is_get?</a></li>
              <li><a target="docwin" href="#method-i-matched_path">matched_path</a></li>
              <li><a target="docwin" href="#method-i-on">on</a></li>
              <li><a target="docwin" href="#method-i-path">path</a></li>
              <li><a target="docwin" href="#method-i-post">post</a></li>
              <li><a target="docwin" href="#method-i-redirect">redirect</a></li>
              <li><a target="docwin" href="#attribute-i-remaining_path">remaining_path</a></li>
              <li><a target="docwin" href="#method-i-response">response</a></li>
              <li><a target="docwin" href="#method-i-roda_class">roda_class</a></li>
              <li><a target="docwin" href="#method-i-root">root</a></li>
              <li><a target="docwin" href="#method-i-run">run</a></li>
              <li><a target="docwin" href="#attribute-i-scope">scope</a></li>
              <li><a target="docwin" href="#method-i-session">session</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COLON</td>
                    <td>=</td>
                    <td class='context-item-value'>":".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>EMPTY_STRING</td>
                    <td>=</td>
                    <td class='context-item-value'>"".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>GET_REQUEST_METHOD</td>
                    <td>=</td>
                    <td class='context-item-value'>'GET'.freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>PATH_INFO</td>
                    <td>=</td>
                    <td class='context-item-value'>"PATH_INFO".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>REQUEST_METHOD</td>
                    <td>=</td>
                    <td class='context-item-value'>"REQUEST_METHOD".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SCRIPT_NAME</td>
                    <td>=</td>
                    <td class='context-item-value'>"SCRIPT_NAME".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SEGMENT</td>
                    <td>=</td>
                    <td class='context-item-value'>"([^\\/]+)".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SESSION_KEY</td>
                    <td>=</td>
                    <td class='context-item-value'>'rack.session'.freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SLASH</td>
                    <td>=</td>
                    <td class='context-item-value'>"/".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>TERM</td>
                    <td>=</td>
                    <td class='context-item-value'>Object.new</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>TERM_INSPECT</td>
                    <td>=</td>
                    <td class='context-item-value'>"TERM".freeze</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-captures'>captures</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The current captures for the request.  This gets modified as routing
                      occurs.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-remaining_path'>remaining_path</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The current path to match requests against.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-scope'>scope</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>The <a href="../../../Roda.html">Roda</a> instance related to this request
                      object.  Useful if routing methods need access to the scope of the <a
                      href="../../../Roda.html">Roda</a> route block.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(scope, env)</span>
                </div>
                <div class='description'>
                  
                  <p>Store the roda instance and environment.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File lib/roda.rb, line 350</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">env</span>)&#x000A;  <span class="ruby-ivar">@scope</span> = <span class="ruby-identifier">scope</span>&#x000A;  <span class="ruby-ivar">@captures</span> = []&#x000A;  <span class="ruby-ivar">@remaining_path</span> = <span class="ruby-identifier">env</span>[<span class="ruby-constant">PATH_INFO</span>]&#x000A;  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">env</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-block_result'>
                <a name='method-i-block_result'></a>
                <div class='synopsis'>
                  <span class='name'>block_result</span>
                  <span class='arguments'>(result)</span>
                </div>
                <div class='description'>
                  
                  <p>Handle match block return values.  By default, if a string is given and the
                  response is empty, use the string as the response body.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-block_result-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-block_result-source'><span class="ruby-comment"># File lib/roda.rb, line 359</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">block_result</span>(<span class="ruby-identifier">result</span>)&#x000A;  <span class="ruby-identifier">res</span> = <span class="ruby-identifier">response</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">body</span> = <span class="ruby-identifier">block_result_body</span>(<span class="ruby-identifier">result</span>))&#x000A;    <span class="ruby-identifier">res</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">body</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-get'>
                <a name='method-i-get'></a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Match GET requests.  If no arguments are provided, matches all GET
                  requests, otherwise, matches only GET requests where the arguments given
                  fully consume the path.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-get-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-get-source'><span class="ruby-comment"># File lib/roda.rb, line 369</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">_verb</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">is_get?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-halt'>
                <a name='method-i-halt'></a>
                <div class='synopsis'>
                  <span class='name'>halt</span>
                  <span class='arguments'>(res=response.finish)</span>
                </div>
                <div class='description'>
                  
                  <p>Immediately stop execution of the route block and return the given rack
                  response array of status, headers, and body.  If no argument is given, uses
                  the current response.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">halt</span> [<span class="ruby-value">200</span>, {<span class="ruby-string">&#39;Content-Type&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-string">&#39;text/html&#39;</span>}, [<span class="ruby-string">&#39;Hello World!&#39;</span>]]&#x000A;&#x000A;<span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">200</span>&#x000A;<span class="ruby-identifier">response</span>[<span class="ruby-string">&#39;Content-Type&#39;</span>] = <span class="ruby-string">&#39;text/html&#39;</span>&#x000A;<span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span> <span class="ruby-string">&#39;Hello World!&#39;</span>&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">halt</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-halt-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-halt-source'><span class="ruby-comment"># File lib/roda.rb, line 383</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">halt</span>(<span class="ruby-identifier">res</span>=<span class="ruby-identifier">response</span>.<span class="ruby-identifier">finish</span>)&#x000A;  <span class="ruby-identifier">throw</span> <span class="ruby-value">:halt</span>, <span class="ruby-identifier">res</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-inspect'>
                <a name='method-i-inspect'></a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Show information about current request, including request class, request
                  method and full path.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">inspect</span>&#x000A;<span class="ruby-comment"># =&gt; &#39;#&lt;Roda::RodaRequest GET /foo/bar&gt;&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-inspect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-inspect-source'><span class="ruby-comment"># File lib/roda.rb, line 392</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>&#x000A;  <span class="ruby-node">&quot;#&lt;#{self.class.inspect} #{@env[REQUEST_METHOD]} #{path}&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-is'>
                <a name='method-i-is'></a>
                <div class='synopsis'>
                  <span class='name'>is</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Does a terminal match on the current path, matching only if the arguments
                  have fully matched the path.  If it matches, the match block is executed,
                  and when the match block returns, the rack response is returned.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>&#x000A;<span class="ruby-comment"># =&gt; &quot;/foo/bar&quot;</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&#39;foo&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># does not match, as path isn&#39;t fully matched (/bar remaining)</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&#39;foo/bar&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># matches as path is empty after matching</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>If no arguments are given, matches if the path is already fully matched.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;foo/bar&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># matches as path is already empty</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Note that this matches only if the path after matching the arguments is
                  empty, not if it still contains a trailing slash:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>&#x000A;<span class="ruby-comment"># =&gt;  &quot;/foo/bar/&quot;</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&#39;foo/bar&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># does not match, as path isn&#39;t fully matched (/ remaining)</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&#39;foo/bar/&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># matches as path is empty after matching</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;foo/bar&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># matches as path is empty after matching</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-is-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-is-source'><span class="ruby-comment"># File lib/roda.rb, line 439</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">is</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">empty_path?</span>&#x000A;      <span class="ruby-identifier">always</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">TERM</span>&#x000A;    <span class="ruby-identifier">if_match</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-is_get-3F'>
                <a name='method-i-is_get-3F'></a>
                <div class='synopsis'>
                  <span class='name'>is_get?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Optimized method for whether this request is a <code>GET</code> request.
                  Similar to the default Rack::Request get? method, but can be overridden
                  without changing rack&#39;s behavior.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-is_get-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-is_get-3F-source'><span class="ruby-comment"># File lib/roda.rb, line 453</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_get?</span>&#x000A;  <span class="ruby-ivar">@env</span>[<span class="ruby-constant">REQUEST_METHOD</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">GET_REQUEST_METHOD</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-matched_path'>
                <a name='method-i-matched_path'></a>
                <div class='synopsis'>
                  <span class='name'>matched_path</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The already matched part of the path, including the original <a
                  href="RequestMethods.html#SCRIPT_NAME">SCRIPT_NAME</a>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-matched_path-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-matched_path-source'><span class="ruby-comment"># File lib/roda.rb, line 493</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">matched_path</span>&#x000A;  <span class="ruby-identifier">e</span> = <span class="ruby-ivar">@env</span>&#x000A;  <span class="ruby-identifier">e</span>[<span class="ruby-constant">SCRIPT_NAME</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>[<span class="ruby-constant">PATH_INFO</span>].<span class="ruby-identifier">chomp</span>(<span class="ruby-ivar">@remaining_path</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-on'>
                <a name='method-i-on'></a>
                <div class='synopsis'>
                  <span class='name'>on</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Does a match on the path, matching only if the arguments have matched the
                  path.  Because this doesn&#39;t fully match the path, this is usually used
                  to setup branches of the routing tree, not for final handling of the
                  request.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>&#x000A;<span class="ruby-comment"># =&gt; &quot;/foo/bar&quot;</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;foo&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># matches, path is /bar after matching</span>&#x000A;<span class="ruby-keyword">end</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;bar&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># does not match</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Like other routing methods, If it matches, the match block is executed, and
                  when the match block returns, the rack response is returned.  However, in
                  general you will call another routing method inside the match block that
                  fully matches the path and does the final handling for the request:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;foo&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&#39;bar&#39;</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># handle /foo/bar request</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-on-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-on-source'><span class="ruby-comment"># File lib/roda.rb, line 484</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">on</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-identifier">always</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">if_match</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-path'>
                <a name='method-i-path'></a>
                <div class='synopsis'>
                  <span class='name'>path</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>This an an optimized version of Rack::Request#path.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;SCRIPT_NAME&#39;</span>] = <span class="ruby-string">&#39;/foo&#39;</span>&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;PATH_INFO&#39;</span>] = <span class="ruby-string">&#39;/bar&#39;</span>&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">path</span>&#x000A;<span class="ruby-comment"># =&gt; &#39;/foo/bar&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-path-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-path-source'><span class="ruby-comment"># File lib/roda.rb, line 504</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">path</span>&#x000A;  <span class="ruby-identifier">e</span> = <span class="ruby-ivar">@env</span>&#x000A;  <span class="ruby-node">&quot;#{e[SCRIPT_NAME]}#{e[PATH_INFO]}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-post'>
                <a name='method-i-post'></a>
                <div class='synopsis'>
                  <span class='name'>post</span>
                  <span class='arguments'>(*args, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Match POST requests.  If no arguments are provided, matches all POST
                  requests, otherwise, matches only POST requests where the arguments given
                  fully consume the path.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-post-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-post-source'><span class="ruby-comment"># File lib/roda.rb, line 515</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">post</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">_verb</span>(<span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">post?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-redirect'>
                <a name='method-i-redirect'></a>
                <div class='synopsis'>
                  <span class='name'>redirect</span>
                  <span class='arguments'>(path=default_redirect_path, status=default_redirect_status)</span>
                </div>
                <div class='description'>
                  
                  <p>Immediately redirect to the path using the status code.  This ends the
                  processing of the request:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/page1&#39;</span>, <span class="ruby-value">301</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>[<span class="ruby-string">&#39;param&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;value1&#39;</span>&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/page2&#39;</span> <span class="ruby-comment"># uses 302 status code</span>&#x000A;<span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">404</span> <span class="ruby-comment"># not reached</span></pre>
                  
                  <p>If you do not provide a path, by default it will redirect to the same path
                  if the request is not a <code>GET</code> request.  This is designed to make
                  it easy to use where a <code>POST</code> request to a URL changes state,
                  <code>GET</code> returns the current state, and you want to show the
                  current state after changing:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&quot;foo&quot;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">get</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># show state</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">post</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># change state</span>&#x000A;    <span class="ruby-identifier">r</span>.<span class="ruby-identifier">redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-redirect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-redirect-source'><span class="ruby-comment"># File lib/roda.rb, line 542</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">path</span>=<span class="ruby-identifier">default_redirect_path</span>, <span class="ruby-identifier">status</span>=<span class="ruby-identifier">default_redirect_status</span>)&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">status</span>)&#x000A;  <span class="ruby-identifier">throw</span> <span class="ruby-value">:halt</span>, <span class="ruby-identifier">response</span>.<span class="ruby-identifier">finish</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-response'>
                <a name='method-i-response'></a>
                <div class='synopsis'>
                  <span class='name'>response</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The response related to the current request.  See <a
                  href="ResponseMethods.html">ResponseMethods</a> for instance methods for
                  the response, but in general the most common usage is to override the
                  response status and headers:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">200</span>&#x000A;<span class="ruby-identifier">response</span>[<span class="ruby-string">&#39;Header-Name&#39;</span>] = <span class="ruby-string">&#39;Header value&#39;</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-response-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-response-source'><span class="ruby-comment"># File lib/roda.rb, line 553</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">response</span>&#x000A;  <span class="ruby-ivar">@scope</span>.<span class="ruby-identifier">response</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-roda_class'>
                <a name='method-i-roda_class'></a>
                <div class='synopsis'>
                  <span class='name'>roda_class</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Return the <a href="../../../Roda.html">Roda</a> class related to this
                  request.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-roda_class-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-roda_class-source'><span class="ruby-comment"># File lib/roda.rb, line 558</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">roda_class</span>&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">roda_class</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-root'>
                <a name='method-i-root'></a>
                <div class='synopsis'>
                  <span class='name'>root</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Routing matches that only matches <code>GET</code> requests where the
                  current path is <code>/</code>.  If it matches, the match block is
                  executed, and when the match block returns, the rack response is returned.</p>
                  
                  <pre class="ruby">[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">request_method</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>]&#x000A;<span class="ruby-comment"># =&gt; [&#39;GET&#39;, &#39;/&#39;]</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">root</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># matches</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>This is usuable inside other match blocks:</p>
                  
                  <pre class="ruby">[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">request_method</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>]&#x000A;<span class="ruby-comment"># =&gt; [&#39;GET&#39;, &#39;/foo/&#39;]</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;foo&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">root</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># matches</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Note that this does not match non-<code>GET</code> requests:</p>
                  
                  <pre class="ruby">[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">request_method</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>]&#x000A;<span class="ruby-comment"># =&gt; [&#39;POST&#39;, &#39;/&#39;]</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">root</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-comment"># does not match</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Use <code>r.post &quot;&quot;</code> for <code>POST</code> requests where
                  the current path is <code>/</code>.</p>
                  
                  <p>Nor does it match empty paths:</p>
                  
                  <pre class="ruby">[<span class="ruby-identifier">r</span>.<span class="ruby-identifier">request_method</span>, <span class="ruby-identifier">r</span>.<span class="ruby-identifier">remaining_path</span>]&#x000A;<span class="ruby-comment"># =&gt; [&#39;GET&#39;, &#39;/foo&#39;]</span>&#x000A;&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">on</span> <span class="ruby-string">&#39;foo&#39;</span> <span class="ruby-keyword">do</span>&#x000A;  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">root</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-comment"># does not match</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Use <code>r.get true</code> to handle <code>GET</code> requests where the
                  current path is empty.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-root-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-root-source'><span class="ruby-comment"># File lib/roda.rb, line 609</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">root</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">remaining_path</span> <span class="ruby-operator">==</span> <span class="ruby-constant">SLASH</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">is_get?</span>&#x000A;    <span class="ruby-identifier">always</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-run'>
                <a name='method-i-run'></a>
                <div class='synopsis'>
                  <span class='name'>run</span>
                  <span class='arguments'>(app)</span>
                </div>
                <div class='description'>
                  
                  <p>Call the given rack app with the environment and return the response from
                  the rack app as the response for this request.  This ends the processing of
                  the request:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">r</span>.<span class="ruby-identifier">run</span>(<span class="ruby-identifier">proc</span>{[<span class="ruby-value">403</span>, {}, []]}) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">r</span>[<span class="ruby-string">&#39;letmein&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;1&#39;</span>&#x000A;<span class="ruby-identifier">r</span>.<span class="ruby-identifier">run</span>(<span class="ruby-identifier">proc</span>{[<span class="ruby-value">404</span>, {}, []]})&#x000A;<span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">404</span> <span class="ruby-comment"># not reached</span></pre>
                  
                  <p>This updates SCRIPT_NAME/PATH_INFO based on the current <a
                  href="RequestMethods.html#attribute-i-remaining_path">#remaining_path</a>
                  before dispatching to another rack app, so the app still works as a URL
                  mapper.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-run-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-run-source'><span class="ruby-comment"># File lib/roda.rb, line 626</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">run</span>(<span class="ruby-identifier">app</span>)&#x000A;  <span class="ruby-identifier">e</span> = <span class="ruby-ivar">@env</span>&#x000A;  <span class="ruby-identifier">path</span> = <span class="ruby-ivar">@remaining_path</span>&#x000A;  <span class="ruby-identifier">sn</span> = <span class="ruby-constant">SCRIPT_NAME</span>&#x000A;  <span class="ruby-identifier">pi</span> = <span class="ruby-constant">PATH_INFO</span>&#x000A;  <span class="ruby-identifier">script_name</span> = <span class="ruby-identifier">e</span>[<span class="ruby-identifier">sn</span>]&#x000A;  <span class="ruby-identifier">path_info</span> = <span class="ruby-identifier">e</span>[<span class="ruby-identifier">pi</span>]&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-identifier">e</span>[<span class="ruby-identifier">sn</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">path_info</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-identifier">path</span>)&#x000A;    <span class="ruby-identifier">e</span>[<span class="ruby-identifier">pi</span>] = <span class="ruby-identifier">path</span>&#x000A;    <span class="ruby-identifier">throw</span> <span class="ruby-value">:halt</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">e</span>)&#x000A;  <span class="ruby-keyword">ensure</span>&#x000A;    <span class="ruby-identifier">e</span>[<span class="ruby-identifier">sn</span>] = <span class="ruby-identifier">script_name</span>&#x000A;    <span class="ruby-identifier">e</span>[<span class="ruby-identifier">pi</span>] = <span class="ruby-identifier">path_info</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-session'>
                <a name='method-i-session'></a>
                <div class='synopsis'>
                  <span class='name'>session</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>The session for the current request.  Raises a <a
                  href="../../RodaError.html">RodaError</a> if a session handler has not been
                  loaded.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-session-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-session-source'><span class="ruby-comment"># File lib/roda.rb, line 645</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">session</span>&#x000A;  <span class="ruby-ivar">@env</span>[<span class="ruby-constant">SESSION_KEY</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">RodaError</span>, <span class="ruby-string">&quot;You&#39;re missing a session handler. You can get started by adding use Rack::Session::Cookie&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
